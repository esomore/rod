(window.webpackJsonp=window.webpackJsonp||[]).push([[0,9],{UIeC:function(t,e,r){"use strict";function n(){return n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},n.apply(this,arguments)}function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function c(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function i(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e){return s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},s(t,e)}function a(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=p(t);if(e){var o=p(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return u(this,r)}}function u(t,e){if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function p(t){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(t)}r.r(e);var l,f,d,h,b,y,v,m,O,j,w,g,P,k,_,C=r("4Iz4"),S=r("3rgF"),I=r("lBHI"),M=r("jMw0"),U=r("jg5f"),D=r("Y3FI"),T=r("L8Yj"),R=r("vI8o"),x=r("rUzK"),F=r("d17u"),z=r("yqR5"),K=r("kv13"),E=r("DrMS"),A=r("3kvY"),B=function(t){function e(){var t;return(t=E.call(this)).followedUsers=new Set,t.followers=new Set,t.cart={},t.carts={},t.state={items:{}},t.id="profile",t.class="public-messages-view",t}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e)}(e,t);var r,u,p,E=a(e);return r=e,u=[{key:"addToCart",value:function(t,e,r){r.stopPropagation();var n=(this.cart[t+e]||0)+1;I.a.local.get("cart").get(e).get(t).put(n)}},{key:"renderUserStore",value:function(t){var e,r=this,n=M.a.channels[t],o=n&&n.uuid,i=!(this.isMyProfile||t.length<40);return e=this.isMyProfile?Object(C.a)(l||(l=c(["<"," currentPhoto="," placeholder="," callback=","/>"])),U.a,this.state.photo,t,(function(t){return r.onProfilePhotoSet(t)})):this.state.photo?Object(C.a)(f||(f=c(["<",' class="profile-photo" src=',"/>"])),T.a,this.state.photo):Object(C.a)(d||(d=c(["<"," str="," width=250/>"])),K.a,t),Object(C.a)(h||(h=c(['\n      <div class="content">\n        <div class="profile-top">\n          <div class="profile-header">\n            <div class="profile-photo-container">\n              ','\n            </div>\n            <div class="profile-header-stuff">\n              <h3 class="profile-name"><'," path= "," placeholder= "," user=",'/></h3>\n              <div class="profile-about hidden-xs">\n                <p class="profile-about-content">\n                  <',' path="store/about" placeholder=',' attr="about" user=','/>\n                </p>\n              </div>\n              <div class="profile-actions">\n                <div class="follow-count">\n                  <a href="/follows/','">\n                    <span>',"</span> ",'\n                  </a>\n                  <a href="/followers/','">\n                    <span>',"</span> ","\n                  </a>\n                </div>\n                ","\n                ","\n                <button onClick=",">","</button>\n                ",'\n              </div>\n            </div>\n          </div>\n          <div class="profile-about visible-xs-flex">\n            <p class="profile-about-content" placeholder='," contenteditable="," onInput=",">","</p>\n          </div>\n        </div>\n\n        <h3>","</h3>\n        ","\n      </div>\n    "])),e,R.a,Object(S.c)("profile_name"),Object(S.c)("name"),t,R.a,Object(S.c)("store_description"),t,t,this.state.followedUserCount,Object(S.c)("following"),t,this.state.followerCount,Object(S.c)("followers"),this.followedUsers.has(M.a.getPubKey())?Object(C.a)(b||(b=c(["\n                  <p><small>","</small></p>\n                "])),Object(S.c)("follows_you")):"",i?Object(C.a)(y||(y=c(["<"," id=","/>"])),z.a,t):"",(function(){return Object(D.route)("/chat/".concat(t))}),Object(S.c)("send_message"),o?"":Object(C.a)(v||(v=c(["\n                  <"," text="," title="," copyStr=","/>\n                "])),F.a,Object(S.c)("copy_link"),this.state.name,window.location.href),this.isMyProfile?Object(S.c)("about"):"",this.isMyProfile,(function(t){return r.onAboutInput(t)}),this.state.about,Object(S.c)("store"),this.renderItems())}},{key:"renderItems",value:function(){var t=this,e=Object.keys(this.cart).reduce((function(e,r){return e+t.cart[r]}),0),r=Object.keys(this.state.items);return Object(C.a)(m||(m=c(["\n      ","\n      ",'\n      <div class="thumbnail-items">\n         ',"\n        ","\n        ","\n      </div>\n    "])),this.props.store||this.state.noFollows?"":Object(C.a)(O||(O=c(["<","/>"])),x.a),e?Object(C.a)(j||(j=c(["\n        <p>\n          <button onClick=",">","(",")</button>\n        </p>\n      "])),(function(){return Object(D.route)("/checkout")}),Object(S.c)("shopping_cart"),e):"",this.isMyProfile?Object(C.a)(w||(w=c(['\n          <div class="thumbnail-item store-item" onClick=','>\n            <a href="/product/new" class="name">',"</a>\n          </div>\n        "])),(function(){return Object(D.route)("/product/new")}),Object(S.c)("add_item")):"",r.length?"":Object(C.a)(g||(g=c(["<p> ","</p>"])),Object(S.c)("no_items_to_show")),r.map((function(e){var r=t.state.items[e];return Object(C.a)(P||(P=c(['\n            <div class="thumbnail-item store-item" onClick=',">\n              <"," src=",'/>\n              <a href="/product/',"/",'" class="name">',"</a>\n              ",'\n              <p class="description">','</p>\n              <p class="price">','</p>\n              <button class="add" onClick=',">\n              ","\n                ","\n              </button>\n            </div>\n          "])),(function(){return Object(D.route)("/product/".concat(e,"/").concat(r.from))}),T.a,r.photo||"",e,r.from||t.props.store,r.name,t.props.store?"":Object(C.a)(k||(k=c(["\n                <small>by <",' path="profile/name" editable="false" placeholder="Name" user=',"/></small>\n              "])),R.a,r.from),r.description,r.price,(function(n){return t.addToCart(e,r.from,n)}),Object(S.c)("add_to_cart"),t.cart[e]?" (".concat(t.cart[e],")"):"")})))}},{key:"renderView",value:function(){return this.props.store?this.renderUserStore(this.props.store):Object(C.a)(_||(_=c(["\n      <p dangerouslySetInnerHTML=","></p>\n      <"," />\n      ","\n    "])),{__html:Object(S.c)("this_is_a_prototype_store",'href="/store/'.concat(M.a.getPubKey(),'"'))},A.a,this.renderItems())}},{key:"updateTotalPrice",value:function(){var t=this,e=Object.keys(this.cart).reduce((function(e,r){var n=t.state.items[r];return e+(n&&parseInt(n.price)||0)*t.cart[r]}),0);this.setState({totalPrice:e})}},{key:"componentDidUpdate",value:function(t){t.store!==this.props.store&&this.componentDidMount()}},{key:"getCartFromUser",value:function(t){var e=this;I.a.local.get("cart").get(t).map(this.sub((function(r,n){"#"!==n&&(e.cart[n+t]=r,e.carts[t]=e.carts[t]||{},e.carts[t][n]=r,e.setState({cart:e.cart,carts:e.carts}),e.updateTotalPrice())}),"cart".concat(t)))}},{key:"onProduct",value:function(t,e,r,c,i){this.eventListeners["products".concat(i)]=c;var s=this.state.items;if(t&&"object"===o(t)){var a={};t.from=i,a[e]=t,n(s,a),this.updateTotalPrice()}else delete s[e];this.setState({items:s})}},{key:"getProductsFromUser",value:function(t){var e=this;I.a.public.user(t).get("store").get("products").map().on(this.sub((function(){for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return e.onProduct.apply(e,n.concat([t]))}),"".concat(t,"products")))}},{key:"getAllCarts",value:function(){var t=this,e={};I.a.local.get("cart").map(this.sub((function(r,n){n?e[n]||(e[n]=!0,t.getCartFromUser(n)):delete e[n]})))}},{key:"getAllProducts",value:function(t){var e=this;I.a.group(t).map("store/products",this.sub((function(){e.onProduct.apply(e,arguments)})))}},{key:"componentDidMount",value:function(){var t,e=this,r=this.props.store;Object.values(this.eventListeners).forEach((function(t){return t.off()})),this.cart={},this.isMyProfile=M.a.getPubKey()===r,r?(this.getCartFromUser(r),this.getProductsFromUser(r)):(I.a.local.get("filters").get("group").on(this.sub((function(r){r&&r!==t&&(t=r,e.getAllProducts(r))}))),this.getAllCarts())}}],u&&i(r.prototype,u),p&&i(r,p),Object.defineProperty(r,"prototype",{writable:!1}),e}(E.a);e.default=B},YVdf:function(t,e,r){"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function i(t,e){return i=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},i(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=u(t);if(e){var o=u(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return a(this,r)}}function a(t,e){if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function u(t){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},u(t)}r.r(e);var p,l,f,d,h,b,y=r("4Iz4"),v=r("lBHI"),m=r("jMw0"),O=r("3rgF"),j=r("Y3FI"),w=r("UIeC"),g=r("vI8o");e.default=function(t){function e(){var t;return(t=u.call(this)).followedUsers=new Set,t.followers=new Set,t}!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&i(t,e)}(e,t);var r,n,a,u=s(e);return r=e,(n=[{key:"addToCart",value:function(){var t=(this.cart[this.props.product]||0)+1;v.a.local.get("cart").get(this.props.store).get(this.props.product).put(t)}},{key:"newProduct",value:function(){var t=this;return Object(y.a)(p||(p=o(['\n      <div class="main-view" id="profile">\n        <div class="content">\n          <a href="/store/','"><',' path="profile/name" placeholder=',"  user="," /></a>\n          <h3> ","</h3>\n          <h2 contenteditable placeholder="," onInput="," />\n          <textarea placeholder="," onInput=",' style="resize: vertical"/>\n          <input type="number" placeholder='," onInput=","/>\n          <hr/>\n          <p>\n            ",":\n          </p>\n          <p>\n            <input placeholder="," onInput="," />\n          </p>\n          <button onClick=",">","</button>\n        </div>\n      </div>\n    "])),m.a.getPubKey(),g.a,Object(O.c)("name"),m.a.getPubKey(),Object(O.c)("add_item"),Object(O.c)("item_id"),(function(e){return t.newProductName=e.target.innerText}),Object(O.c)("item_description"),(function(e){return t.newProductDescription=e.target.value}),Object(O.c)("price"),(function(e){return t.newProductPrice=parseInt(e.target.value)}),Object(O.c)("item_id"),Object(O.c)("item_id"),(function(e){return t.newProductId=e.target.value}),(function(e){return t.addItemClicked(e)}),Object(O.c)("add_item"))}},{key:"onClickDelete",value:function(){confirm("Delete product? This cannot be undone.")&&(v.a.public.user().get("store").get("products").get(this.props.product).put(null),Object(j.route)("/store/".concat(this.props.store)))}},{key:"showProduct",value:function(){var t=this,e=Object.values(this.cart).reduce((function(t,e){return t+e}),0);return this.state.product?Object(y.a)(f||(f=o(['\n    <div class="main-view" id="profile">\n      <div class="content">\n        <a href="/store/','"><',' editable="false" path="profile/name" user=',"/></a>\n        ","\n        ","\n      </div>\n    </div>"])),this.props.store,g.a,this.props.store,e?Object(y.a)(d||(d=o(["\n          <p>\n            <button onClick=",">"," (",")</button>\n          </p>\n        "])),(function(){return Object(j.route)("/checkout/".concat(t.props.store))}),Object(O.c)("shopping_cart"),e):"",this.state.product?Object(y.a)(h||(h=o(["\n          <",' tag="h3" user=',' path="store/products/','/name"/>\n          <iris-img btn-class="btn btn-primary" user=',' path="store/products/','/photo"/>\n          <p class="description">\n            <'," user=",' path="store/products/','/description"/>\n          </p>\n          <p class="price">\n            <'," placeholder="," user=",' path="store/products/','/price"/>\n          </p>\n          <button class="add" onClick=',">\n            ","\n            ","\n          </button>\n          ","\n        "])),g.a,this.props.store,this.props.product,this.props.store,this.props.product,g.a,this.props.store,this.props.product,g.a,Object(O.c)("price"),this.props.store,this.props.product,(function(){return t.addToCart()}),Object(O.c)("add_to_cart"),this.cart[this.props.product]?" (".concat(this.cart[this.props.product],")"):"",this.isMyProfile?Object(y.a)(b||(b=o(["\n            <p><button onClick=",">","</button></p>\n          "])),(function(e){return t.onClickDelete(e)}),Object(O.c)("delete_item")):""):""):Object(y.a)(l||(l=o([""])))}},{key:"render",value:function(){return this.props.store&&this.props.product?this.showProduct():this.newProduct()}},{key:"componentDidUpdate",value:function(t){t.product!==this.props.product&&this.componentDidMount()}},{key:"addItemClicked",value:function(){var t={name:this.newProductName,description:this.newProductDescription,price:this.newProductPrice};v.a.public.user().get("store").get("products").get(this.newProductId||this.newProductName).put(t),Object(j.route)("/store/".concat(m.a.getPubKey()))}},{key:"componentDidMount",value:function(){var t=this;w.default.prototype.componentDidMount.call(this);var e=this.props.store;this.setState({followedUserCount:0,followerCount:0,name:"",photo:"",about:""}),this.isMyProfile=m.a.getPubKey()===e,this.props.product&&e&&v.a.public.user(e).get("store").get("products").get(this.props.product).on((function(e){return t.setState({product:e})}))}}])&&c(r.prototype,n),a&&c(r,a),Object.defineProperty(r,"prototype",{writable:!1}),e}(w.default)}}]);
//# sourceMappingURL=0.chunk.ba205.js.map